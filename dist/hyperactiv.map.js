!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.hyperactiv=t()}(this,function(){"use strict";const e=[],t=new WeakMap,n=function(e){return e&&"object"==typeof e&&!(e instanceof Date)},o=Array.isArray,r=function(e,t,o,u){Object.defineProperty(e,"__key",{value:t,enumerable:!1,configurable:!0}),Object.defineProperty(e,"__parent",{value:o,enumerable:!1,configurable:!0}),u&&Object.entries(e).forEach(function([t,o]){!n(o)||o.__key&&o.__parent||r(e[t],t,e)})},u={timeout:null,queue:new Set,process(){for(const e of u.queue)e();u.queue.clear(),u.timeout=null},enqueue(e){null===u.timeout&&(u.timeout=setTimeout(u.process,0)),u.queue.add(e)}},c=function(t,{autoRun:n=!0,callback:o=null,bind:r=null}={}){const u=new Proxy(t,{apply(t,n,c){const s=function(s=null){e.unshift(o||u);const i=s?s():t.apply(r||n,c);return e.shift(),i};return c.push({computeAsync:function(e){return s(e)}}),s()}});return n&&u(),u},s=function(e){return e.__disposed=!0},i=function(c,s={}){const{props:f=null,ignore:l=null,batch:p=!1,deep:a=!1,handler:d=null,bind:b=!1}=s;if(c.__observed)return c;t.set(c,new Map),a&&Object.entries(c).forEach(function([e,t]){n(t)&&(c[e]=i(t,s),d&&r(c[e],e,c))});const _=new Proxy(c,{get(n,o){if("__observed"===o)return!0;if((!f||f.includes(o))&&(!l||!l.includes(o))&&e.length){const n=t.get(c);n.has(o)||n.set(o,new Set),n.get(o).add(e[0])}return c[o]},set(b,y,h){const m=t.get(c);if((!o(c)||"length"!==y)&&c[y]===h)return!0;const g=c[y];if(c[y]=a&&n(h)?i(h,s):h,d&&a&&n(h)&&r(c[y],y,c,a),d){const e=[y];let t=c;for(;t.__key&&t.__parent;)e.unshift(t.__key),t=t.__parent;d(e,h,g,_)}if((!f||f.includes(y))&&(!l||!l.includes(y))&&m.has(y)){const t=m.get(y);for(const n of t)n.__disposed?t.delete(n):n!==e[0]&&(p?u.enqueue(n):n())}return!0}});if(b){[...Object.getOwnPropertyNames(c),...Object.getPrototypeOf(c)&&["String","Number","Object","Array","Boolean","Date"].indexOf(Object.getPrototypeOf(c).constructor.name)<0?Object.getOwnPropertyNames(Object.getPrototypeOf(c)):[]].filter(e=>"constructor"!=e&&"function"==typeof c[e]).forEach(e=>c[e]=c[e].bind(_))}return _};return{observe:i,computed:c,dispose:s,Observable:e=>(class extends e{constructor(e,t){super();const n=i(e||{},t||{deep:!0,batch:!0});return new Proxy(this,{set:(e,t,o)=>("function"==typeof o?this[t]=o:(n[t]=o,void 0===this[t]&&Object.defineProperty(this,t,{get:()=>n[t],enumerable:!0,configurable:!0})),!0),deleteProperty:(e,t)=>(delete n[t],delete e[t],!0)})}}),Computable:e=>(class extends e{constructor(){super(),Object.defineProperty(this,"__computed",{value:[],enumerable:!1})}computed(e){this.__computed.push(c(e))}dispose(){for(;this.__computed.length;)s(this.__computed.pop())}}),container:function(e){return"function"==typeof e&&(e={deep:!0,batch:!0,handler:e}),i({},e)}}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHlwZXJhY3Rpdi5tYXAuanMiLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBjb21wdXRlZFN0YWNrID0gW11cbmNvbnN0IG9ic2VydmVyc01hcCA9IG5ldyBXZWFrTWFwKClcblxuLyogVG9vbHMgKi9cblxuY29uc3QgaXNPYmogPSBmdW5jdGlvbihvKSB7IHJldHVybiBvICYmIHR5cGVvZiBvID09PSAnb2JqZWN0JyAmJiAhKG8gaW5zdGFuY2VvZiBEYXRlKSB9XG5jb25zdCBpc0FycmF5ID0gQXJyYXkuaXNBcnJheVxuY29uc3QgZGVmaW5lQnViYmxpbmdQcm9wZXJ0aWVzID0gZnVuY3Rpb24ob2JqZWN0LCBrZXksIHBhcmVudCwgZGVlcCkge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmplY3QsICdfX2tleScsIHsgdmFsdWU6IGtleSwgZW51bWVyYWJsZTogZmFsc2UsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9KVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmplY3QsICdfX3BhcmVudCcsIHsgdmFsdWU6IHBhcmVudCwgZW51bWVyYWJsZTogZmFsc2UsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9KVxuICAgIGRlZXAgJiYgT2JqZWN0LmVudHJpZXMob2JqZWN0KS5mb3JFYWNoKGZ1bmN0aW9uKFtrZXksIHZhbF0pIHtcbiAgICAgICAgaWYoaXNPYmoodmFsKSAmJiAoIXZhbC5fX2tleSB8fCAhdmFsLl9fcGFyZW50KSkgZGVmaW5lQnViYmxpbmdQcm9wZXJ0aWVzKG9iamVjdFtrZXldLCBrZXksIG9iamVjdClcbiAgICB9KVxufVxuXG5jb25zdCBiYXRjaGVyID0ge1xuICAgIHRpbWVvdXQ6IG51bGwsXG4gICAgcXVldWU6IG5ldyBTZXQoKSxcbiAgICBwcm9jZXNzKCkge1xuICAgICAgICBmb3IoY29uc3QgdGFzayBvZiBiYXRjaGVyLnF1ZXVlKSB0YXNrKClcbiAgICAgICAgYmF0Y2hlci5xdWV1ZS5jbGVhcigpXG4gICAgICAgIGJhdGNoZXIudGltZW91dCA9IG51bGxcbiAgICB9LFxuICAgIGVucXVldWUodGFzaykge1xuICAgICAgICBpZihiYXRjaGVyLnRpbWVvdXQgPT09IG51bGwpXG4gICAgICAgICAgICBiYXRjaGVyLnRpbWVvdXQgPSBzZXRUaW1lb3V0KGJhdGNoZXIucHJvY2VzcywgMClcbiAgICAgICAgYmF0Y2hlci5xdWV1ZS5hZGQodGFzaylcbiAgICB9XG59XG5cbi8qIENvbXB1dGVkICovXG5cbmNvbnN0IGNvbXB1dGVkID0gZnVuY3Rpb24oZnVuLCB7IGF1dG9SdW4gPSB0cnVlLCBjYWxsYmFjayA9IG51bGwsIGJpbmQgPSBudWxsIH0gPSB7fSkge1xuICAgIC8vIFByb3hpZnkgdGhlIGZ1bmN0aW9uIGluIG9yZGVyIHRvIGludGVyY2VwdCB0aGUgY2FsbHNcbiAgICBjb25zdCBwcm94eSA9IG5ldyBQcm94eShmdW4sIHtcbiAgICAgICAgYXBwbHkodGFyZ2V0LCB0aGlzQXJnLCBhcmdzTGlzdCkge1xuICAgICAgICAgICAgLy8gU3RvcmUgdGhlIGZ1bmN0aW9uIHdoaWNoIGlzIGJlaW5nIGNvbXB1dGVkIGluc2lkZSBhIHN0YWNrXG4gICAgICAgICAgICBjb25zdCBwZXJmb3JtQ29tcHV0YXRpb24gPSBmdW5jdGlvbihmdW4gPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29tcHV0ZWRTdGFjay51bnNoaWZ0KGNhbGxiYWNrIHx8IHByb3h5KVxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGZ1biA/IGZ1bigpIDogdGFyZ2V0LmFwcGx5KGJpbmQgfHwgdGhpc0FyZywgYXJnc0xpc3QpXG4gICAgICAgICAgICAgICAgY29tcHV0ZWRTdGFjay5zaGlmdCgpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJbmplY3QgdGhlIGNvbXB1dGVBc3luYyBhcmd1bWVudCB3aGljaCBpcyB1c2VkIHRvIG1hbnVhbGx5IGRlY2xhcmUgd2hlbiB0aGUgY29tcHV0YXRpb24gdGFrZXMgcGFydFxuICAgICAgICAgICAgYXJnc0xpc3QucHVzaCh7XG4gICAgICAgICAgICAgICAgY29tcHV0ZUFzeW5jOiBmdW5jdGlvbih0YXJnZXQpIHsgcmV0dXJuIHBlcmZvcm1Db21wdXRhdGlvbih0YXJnZXQpIH1cbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIHJldHVybiBwZXJmb3JtQ29tcHV0YXRpb24oKVxuICAgICAgICB9XG4gICAgfSlcbiAgICAvLyBJZiBhdXRvUnVuLCB0aGVuIGNhbGwgdGhlIGZ1bmN0aW9uIGF0IG9uY2VcbiAgICBpZihhdXRvUnVuKSBwcm94eSgpXG4gICAgcmV0dXJuIHByb3h5XG59XG5cbi8qIERpc3Bvc2UgKi9cblxuLy8gVGhlIGRpc3Bvc2VkIGZsYWcgd2hpY2ggaXMgdXNlZCB0byByZW1vdmUgYSBjb21wdXRlZCBmdW5jdGlvbiByZWZlcmVuY2UgcG9pbnRlclxuY29uc3QgZGlzcG9zZSA9IGZ1bmN0aW9uKF8pIHsgcmV0dXJuIF8uX19kaXNwb3NlZCA9IHRydWUgfVxuXG4vKiBPYnNlcnZlICovXG5cbmNvbnN0IG9ic2VydmUgPSBmdW5jdGlvbihvYmosIG9wdGlvbnMgPSB7fSkge1xuICAgIGNvbnN0IHtcbiAgICAgICAgcHJvcHMgPSBudWxsLCBpZ25vcmUgPSBudWxsLCBiYXRjaCA9IGZhbHNlLCBkZWVwID0gZmFsc2UsIGhhbmRsZXIgPSBudWxsLCBiaW5kID0gZmFsc2VcbiAgICB9ID0gb3B0aW9uc1xuXG4gICAgLy8gSWdub3JlIGlmIHRoZSBvYmplY3QgaXMgYWxyZWFkeSBvYnNlcnZlZFxuICAgIGlmKG9iai5fX29ic2VydmVkKSByZXR1cm4gb2JqXG5cbiAgICAvLyBBZGQgdGhlIG9iamVjdCB0byB0aGUgb2JzZXJ2ZXJzIG1hcC5cbiAgICAvLyBvYnNlcnZlcnNNYXAgc2lnbmF0dXJlIDogTWFwPE9iamVjdCwgTWFwPFByb3BlcnR5LCBTZXQ8Q29tcHV0ZWQgZnVuY3Rpb24+Pj5cbiAgICAvLyBJbiBlbmdsaXNoIDpcbiAgICAvLyBvYnNlcnZlcnNNYXAgaXMgYSBtYXAgb2Ygb2JzZXJ2ZWQgb2JqZWN0cy5cbiAgICAvLyBGb3IgZWFjaCBvYnNlcnZlZCBvYmplY3QsIGVhY2ggcHJvcGVydHkgaXMgbWFwcGVkIHdpdGggYSBzZXQgb2YgY29tcHV0ZWQgZnVuY3Rpb25zIGRlcGVuZGluZyBvbiB0aGlzIHByb3BlcnR5LlxuICAgIC8vIFdoZW5ldmVyIGEgcHJvcGVydHkgaXMgc2V0LCB3ZSByZS1ydW4gZWFjaCBvbmUgb2YgdGhlIGZ1bmN0aW9ucyBzdG9yZWQgaW5zaWRlIHRoZSBtYXRjaGluZyBTZXQuXG4gICAgb2JzZXJ2ZXJzTWFwLnNldChvYmosIG5ldyBNYXAoKSlcblxuICAgIC8vIElmIHRoZSBkZWVwIGZsYWcgaXMgc2V0LCBvYnNlcnZlIG5lc3RlZCBvYmplY3RzL2FycmF5c1xuICAgIGRlZXAgJiYgT2JqZWN0LmVudHJpZXMob2JqKS5mb3JFYWNoKGZ1bmN0aW9uKFtrZXksIHZhbF0pIHtcbiAgICAgICAgaWYoaXNPYmoodmFsKSkge1xuICAgICAgICAgICAgb2JqW2tleV0gPSBvYnNlcnZlKHZhbCwgb3B0aW9ucylcbiAgICAgICAgICAgIC8vIElmIGEgaGFuZGxlciBpcyBzZXQsIHdlIGFkZCBrZXlzIHRvIHRoZSBvYmplY3QgdXNlZCB0byBidWJibGUgdXAgdGhlIG11dGF0aW9uXG4gICAgICAgICAgICBpZihoYW5kbGVyKVxuICAgICAgICAgICAgICAgIGRlZmluZUJ1YmJsaW5nUHJvcGVydGllcyhvYmpba2V5XSwga2V5LCBvYmopXG4gICAgICAgIH1cbiAgICB9KVxuXG4gICAgLy8gUHJveGlmeSB0aGUgb2JqZWN0IGluIG9yZGVyIHRvIGludGVyY2VwdCBnZXQvc2V0IG9uIHByb3BzXG4gICAgY29uc3QgcHJveHkgPSBuZXcgUHJveHkob2JqLCB7XG4gICAgICAgIGdldChfLCBwcm9wKSB7XG4gICAgICAgICAgICBpZihwcm9wID09PSAnX19vYnNlcnZlZCcpIHJldHVybiB0cnVlXG5cbiAgICAgICAgICAgIC8vIElmIHRoZSBwcm9wIGlzIHdhdGNoZWRcbiAgICAgICAgICAgIGlmKCghcHJvcHMgfHwgcHJvcHMuaW5jbHVkZXMocHJvcCkpICYmICghaWdub3JlIHx8ICFpZ25vcmUuaW5jbHVkZXMocHJvcCkpKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgYSBjb21wdXRlZCBmdW5jdGlvbiBpcyBiZWluZyBydW5cbiAgICAgICAgICAgICAgICBpZihjb21wdXRlZFN0YWNrLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9wZXJ0aWVzTWFwID0gb2JzZXJ2ZXJzTWFwLmdldChvYmopXG4gICAgICAgICAgICAgICAgICAgIGlmKCFwcm9wZXJ0aWVzTWFwLmhhcyhwcm9wKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXNNYXAuc2V0KHByb3AsIG5ldyBTZXQoKSlcbiAgICAgICAgICAgICAgICAgICAgLy8gTGluayB0aGUgY29tcHV0ZWQgZnVuY3Rpb24gYW5kIHRoZSBwcm9wZXJ0eSBiZWluZyBhY2Nlc3NlZFxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzTWFwLmdldChwcm9wKS5hZGQoY29tcHV0ZWRTdGFja1swXSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBvYmpbcHJvcF1cbiAgICAgICAgfSxcbiAgICAgICAgc2V0KF8sIHByb3AsIHZhbHVlKSB7XG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0aWVzTWFwID0gb2JzZXJ2ZXJzTWFwLmdldChvYmopXG5cbiAgICAgICAgICAgIC8vIElmIHRoZSBuZXcvb2xkIHZhbHVlIGFyZSBlcXVhbCwgcmV0dXJuXG4gICAgICAgICAgICBpZigoIWlzQXJyYXkob2JqKSB8fCBwcm9wICE9PSAnbGVuZ3RoJykgJiYgb2JqW3Byb3BdID09PSB2YWx1ZSkgcmV0dXJuIHRydWVcbiAgICAgICAgICAgIC8vIFJlbWVtYmVyIG9sZCB2YWx1ZSBmb3IgaGFuZGxlclxuICAgICAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSBvYmpbcHJvcF1cbiAgICAgICAgICAgIC8vIElmIHRoZSBkZWVwIGZsYWcgaXMgc2V0IHdlIG9ic2VydmUgdGhlIG5ld2x5IHNldCB2YWx1ZVxuICAgICAgICAgICAgb2JqW3Byb3BdID0gZGVlcCAmJiBpc09iaih2YWx1ZSkgPyBvYnNlcnZlKHZhbHVlLCBvcHRpb25zKSA6IHZhbHVlXG4gICAgICAgICAgICAvLyBJZiB3ZSBkZWZpbmVkIGEgaGFuZGxlciwgd2UgZGVmaW5lIHRoZSBidWJibGluZyBrZXlzIHJlY3Vyc2l2ZWx5IG9uIHRoZSBuZXcgdmFsdWVcbiAgICAgICAgICAgIGhhbmRsZXIgJiYgZGVlcCAmJiBpc09iaih2YWx1ZSkgJiYgZGVmaW5lQnViYmxpbmdQcm9wZXJ0aWVzKG9ialtwcm9wXSwgcHJvcCwgb2JqLCBkZWVwKVxuXG4gICAgICAgICAgICBpZihoYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgLy8gUmV0cmlldmUgdGhlIG11dGF0ZWQgcHJvcGVydGllcyBjaGFpbiAmIGNhbGwgdGhlIGhhbmRsZXJcbiAgICAgICAgICAgICAgICBjb25zdCBhbmNlc3RyeSA9IFsgcHJvcCBdXG4gICAgICAgICAgICAgICAgbGV0IHBhcmVudCA9IG9ialxuICAgICAgICAgICAgICAgIHdoaWxlKHBhcmVudC5fX2tleSAmJiBwYXJlbnQuX19wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0cnkudW5zaGlmdChwYXJlbnQuX19rZXkpXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudCA9IHBhcmVudC5fX3BhcmVudFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBoYW5kbGVyKGFuY2VzdHJ5LCB2YWx1ZSwgb2xkVmFsdWUsIHByb3h5KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJZiB0aGUgcHJvcCBpcyB3YXRjaGVkXG4gICAgICAgICAgICBpZigoIXByb3BzIHx8IHByb3BzLmluY2x1ZGVzKHByb3ApKSAmJiAoIWlnbm9yZSB8fCAhaWdub3JlLmluY2x1ZGVzKHByb3ApKSkge1xuICAgICAgICAgICAgICAgIGlmKHByb3BlcnRpZXNNYXAuaGFzKHByb3ApKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJldHJpZXZlIHRoZSBjb21wdXRlZCBmdW5jdGlvbnMgZGVwZW5kaW5nIG9uIHRoZSBwcm9wXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlcGVuZGVudHMgPSBwcm9wZXJ0aWVzTWFwLmdldChwcm9wKVxuICAgICAgICAgICAgICAgICAgICBmb3IoY29uc3QgZGVwZW5kZW50IG9mIGRlcGVuZGVudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIGRpc3Bvc2VkLCBkZWxldGUgdGhlIGZ1bmN0aW9uIHJlZmVyZW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoZGVwZW5kZW50Ll9fZGlzcG9zZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXBlbmRlbnRzLmRlbGV0ZShkZXBlbmRlbnQpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYoZGVwZW5kZW50ICE9PSBjb21wdXRlZFN0YWNrWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUnVuIHRoZSBjb21wdXRlZCBmdW5jdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJhdGNoKSBiYXRjaGVyLmVucXVldWUoZGVwZW5kZW50KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgZGVwZW5kZW50KClcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgIH1cbiAgICB9KVxuXG4gICAgaWYoYmluZCkge1xuICAgICAgICAvLyBOZWVkIHRoaXMgZm9yIGJpbmRpbmcgZXM2IGNsYXNzZXMgbWV0aG9kcyB3aGljaCBhcmUgc3RvcmVkIGluIHRoZSBvYmplY3QgcHJvdG90eXBlXG4gICAgICAgIGNvbnN0IG1ldGhvZHMgPSBbXG4gICAgICAgICAgICAuLi5PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvYmopLFxuICAgICAgICAgICAgLi4uT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iaikgJiYgWydTdHJpbmcnLCAnTnVtYmVyJywgJ09iamVjdCcsICdBcnJheScsICdCb29sZWFuJywgJ0RhdGUnXS5pbmRleE9mKE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmopLmNvbnN0cnVjdG9yLm5hbWUpIDwgMCA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmopKSA6IFtdXG4gICAgICAgIF0uZmlsdGVyKHByb3AgPT4gcHJvcCAhPSAnY29uc3RydWN0b3InICYmIHR5cGVvZiBvYmpbcHJvcF0gPT09ICdmdW5jdGlvbicpXG4gICAgICAgIG1ldGhvZHMuZm9yRWFjaChrZXkgPT4gb2JqW2tleV0gPSBvYmpba2V5XS5iaW5kKHByb3h5KSlcbiAgICB9XG5cbiAgICByZXR1cm4gcHJveHlcbn1cblxuLyogT2JzZXJ2YWJsZSAqL1xuXG5jb25zdCBPYnNlcnZhYmxlID0gQmFzZSA9PiBjbGFzcyBleHRlbmRzIEJhc2Uge1xuICAgIGNvbnN0cnVjdG9yKGRhdGEsIG9wdGlvbnMpIHtcbiAgICAgICAgc3VwZXIoKVxuICAgICAgICBjb25zdCBzdG9yZSA9IG9ic2VydmUoZGF0YSB8fCB7IH0sIG9wdGlvbnMgfHwgeyBkZWVwOiB0cnVlLCBiYXRjaDogdHJ1ZSB9KVxuICAgICAgICByZXR1cm4gbmV3IFByb3h5KHRoaXMsIHtcbiAgICAgICAgICAgIHNldDogKG9iaiwgbmFtZSwgdmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICBpZih0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1tuYW1lXSA9IHZhbHVlXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RvcmVbbmFtZV0gPSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBpZih0aGlzW25hbWVdID09PSB1bmRlZmluZWQpIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBuYW1lLCB7IGdldDogKCkgPT4gc3RvcmVbbmFtZV0sIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRlbGV0ZVByb3BlcnR5OiAob2JqLCBuYW1lKSA9PiB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHN0b3JlW25hbWVdXG4gICAgICAgICAgICAgICAgZGVsZXRlIG9ialtuYW1lXVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxufVxuXG4vKiBDb21wdXRhYmxlICovXG5cbmNvbnN0IENvbXB1dGFibGUgPSBCYXNlID0+IGNsYXNzIGV4dGVuZHMgQmFzZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKClcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdfX2NvbXB1dGVkJywgeyB2YWx1ZTogWyBdLCBlbnVtZXJhYmxlOiBmYWxzZSB9KVxuICAgIH1cbiAgICBjb21wdXRlZChmbikge1xuICAgICAgICB0aGlzLl9fY29tcHV0ZWQucHVzaChjb21wdXRlZChmbikpXG4gICAgfVxuICAgIGRpc3Bvc2UoKSB7XG4gICAgICAgIHdoaWxlKHRoaXMuX19jb21wdXRlZC5sZW5ndGgpIGRpc3Bvc2UodGhpcy5fX2NvbXB1dGVkLnBvcCgpKVxuICAgIH1cbn1cblxuLyogY29udGFpbmVyICovXG5cbmNvbnN0IGNvbnRhaW5lciA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICBpZih0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykgb3B0aW9ucyA9IHsgZGVlcDogdHJ1ZSwgYmF0Y2g6IHRydWUsIGhhbmRsZXI6IG9wdGlvbnMgfVxuICAgIHJldHVybiBvYnNlcnZlKHsgfSwgb3B0aW9ucylcbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICAgIG9ic2VydmUsXG4gICAgY29tcHV0ZWQsXG4gICAgZGlzcG9zZSxcbiAgICBPYnNlcnZhYmxlLFxuICAgIENvbXB1dGFibGUsXG4gICAgY29udGFpbmVyXG59Il0sIm5hbWVzIjpbImNvbXB1dGVkU3RhY2siLCJvYnNlcnZlcnNNYXAiLCJXZWFrTWFwIiwiaXNPYmoiLCJvIiwiRGF0ZSIsImlzQXJyYXkiLCJBcnJheSIsImRlZmluZUJ1YmJsaW5nUHJvcGVydGllcyIsIm9iamVjdCIsImtleSIsInBhcmVudCIsImRlZXAiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsImVudHJpZXMiLCJmb3JFYWNoIiwidmFsIiwiX19rZXkiLCJfX3BhcmVudCIsImJhdGNoZXIiLCJ0aW1lb3V0IiwicXVldWUiLCJTZXQiLCJbb2JqZWN0IE9iamVjdF0iLCJ0YXNrIiwiY2xlYXIiLCJzZXRUaW1lb3V0IiwicHJvY2VzcyIsImFkZCIsImNvbXB1dGVkIiwiZnVuIiwiYXV0b1J1biIsImNhbGxiYWNrIiwiYmluZCIsInByb3h5IiwiUHJveHkiLCJ0YXJnZXQiLCJ0aGlzQXJnIiwiYXJnc0xpc3QiLCJwZXJmb3JtQ29tcHV0YXRpb24iLCJ1bnNoaWZ0IiwicmVzdWx0IiwiYXBwbHkiLCJzaGlmdCIsInB1c2giLCJjb21wdXRlQXN5bmMiLCJkaXNwb3NlIiwiXyIsIl9fZGlzcG9zZWQiLCJvYnNlcnZlIiwib2JqIiwib3B0aW9ucyIsInByb3BzIiwiaWdub3JlIiwiYmF0Y2giLCJoYW5kbGVyIiwiX19vYnNlcnZlZCIsInNldCIsIk1hcCIsInByb3AiLCJpbmNsdWRlcyIsImxlbmd0aCIsInByb3BlcnRpZXNNYXAiLCJnZXQiLCJoYXMiLCJvbGRWYWx1ZSIsImFuY2VzdHJ5IiwiZGVwZW5kZW50cyIsImRlcGVuZGVudCIsImRlbGV0ZSIsImVucXVldWUiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwiZ2V0UHJvdG90eXBlT2YiLCJpbmRleE9mIiwiY29uc3RydWN0b3IiLCJuYW1lIiwiZmlsdGVyIiwiT2JzZXJ2YWJsZSIsIkJhc2UiLCJkYXRhIiwic3VwZXIiLCJzdG9yZSIsInRoaXMiLCJ1bmRlZmluZWQiLCJkZWxldGVQcm9wZXJ0eSIsIkNvbXB1dGFibGUiLCJmbiIsIl9fY29tcHV0ZWQiLCJwb3AiLCJjb250YWluZXIiXSwibWFwcGluZ3MiOiJzTEFBQSxNQUFNQSxLQUNBQyxFQUFlLElBQUlDLFFBSW5CQyxFQUFRLFNBQVNDLEdBQUssT0FBT0EsR0FBa0IsaUJBQU5BLEtBQW9CQSxhQUFhQyxPQUMxRUMsRUFBVUMsTUFBTUQsUUFDaEJFLEVBQTJCLFNBQVNDLEVBQVFDLEVBQUtDLEVBQVFDLEdBQzNEQyxPQUFPQyxlQUFlTCxFQUFRLFNBQVdNLE1BQU9MLEVBQUtNLFlBQVksRUFBT0MsY0FBYyxJQUN0RkosT0FBT0MsZUFBZUwsRUFBUSxZQUFjTSxNQUFPSixFQUFRSyxZQUFZLEVBQU9DLGNBQWMsSUFDNUZMLEdBQVFDLE9BQU9LLFFBQVFULEdBQVFVLFFBQVEsVUFBVVQsRUFBS1UsS0FDL0NqQixFQUFNaUIsSUFBVUEsRUFBSUMsT0FBVUQsRUFBSUUsVUFBV2QsRUFBeUJDLEVBQU9DLEdBQU1BLEVBQUtELE1BSTdGYyxHQUNGQyxRQUFTLEtBQ1RDLE1BQU8sSUFBSUMsSUFDWEMsVUFDSSxJQUFJLE1BQU1DLEtBQVFMLEVBQVFFLE1BQU9HLElBQ2pDTCxFQUFRRSxNQUFNSSxRQUNkTixFQUFRQyxRQUFVLE1BRXRCRyxRQUFRQyxHQUNtQixPQUFwQkwsRUFBUUMsVUFDUEQsRUFBUUMsUUFBVU0s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
